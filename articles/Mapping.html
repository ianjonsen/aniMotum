<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapping • aniMotum</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mapping">
<meta property="og:description" content="aniMotum">
<meta property="og:image" content="https://ianjonsen.github.io/aniMotum/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aniMotum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2-03.9100</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/SSM_fitting.html">SSM_fitting</a>
    </li>
    <li>
      <a href="../articles/SSM_validation.html">SSM_validation</a>
    </li>
    <li>
      <a href="../articles/Move_persistence_models.html">Move_persistence_models</a>
    </li>
    <li>
      <a href="../articles/Track_simulation.html">Track_simulation</a>
    </li>
    <li>
      <a href="../articles/Mapping.html">Mapping</a>
    </li>
    <li>
      <a href="../articles/Path_rerouting.html">Path_rerouting</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/ianjonsen/aniMotum" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mapping</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ianjonsen/aniMotum/blob/HEAD/vignettes/Mapping.Rmd" class="external-link"><code>vignettes/Mapping.Rmd</code></a></small>
      <div class="hidden name"><code>Mapping.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="map">
<code>map()</code><a class="anchor" aria-label="anchor" href="#map"></a>
</h2>
<p><code>aniMotum</code> provides a flexible <code>map</code> function
for mapping SSM-estimated tracks along with options for including their
confidence ellipses, observed locations, track lines, and behavioural
estimates. Default choices are made based on the model fit object being
mapped but these can be overridden via the <code>aes</code> argument and
the <code><a href="../reference/aes_lst.html">aes_lst()</a></code> function.</p>
<div class="section level4">
<h4 id="map-an-ssm-fit-to-data-using-default-settings">Map an SSM fit to data, using default settings<a class="anchor" aria-label="anchor" href="#map-an-ssm-fit-to-data-using-default-settings"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sese</span>, <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_ssm.html">fit_ssm</a></span><span class="op">(</span><span class="va">se2</span>, </span>
<span>               model <span class="op">=</span> <span class="st">"mp"</span>, </span>
<span>               time.step <span class="op">=</span> <span class="fl">24</span>, </span>
<span>               control <span class="op">=</span> <span class="fu"><a href="../reference/ssm_control.html">ssm_control</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"predicted"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_1a.jpg" style="width:95.0%"></p>
<p>Here, SSM-predicted locations are coloured by the estimated move
persistence index (<span class="math inline">\(\gamma_t\)</span>). To
aid visualisation of high and low move persistence regions along each
track, the <span class="math inline">\(\gamma_t\)</span> estimates are
normalised separately for each track to span the interval 0,1. This can
be turned off with <code>normalise = FALSE</code>, or applied to the
group of tracks with <code>group = TRUE</code>.</p>
<p>By default, <code><a href="../reference/map.html">map()</a></code> will try to use
<code>rnaturalearth::ne_countries(scale = 10)</code> high-resolution
land polygon data if the <code>rnaturalearthhires</code> data package is
installed. If not, the default will be dropped to the coarser
<code>scale=50</code>. The <code>rnaturalearthhires</code> package can
be installed via:
<code>install.packages("rnaturalearthhires", repos = "https://ropensci.r-universe.dev")</code>
or <code>remotes::install_github("ropensci/rnaturalearthhires")</code>.
Alternatively, if the <code>ggpstial</code> and <code>rosm</code>
packages are installed, users may specify any of the available tile map
layers returned by <code><a href="https://rdrr.io/pkg/rosm/man/deprecated.html" class="external-link">rosm::osm.types()</a></code> via the
<code>map_type</code> argument. When specifying a <code>map_type</code>,
<code>map</code> will take any additional arguments to
<code><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">ggspatial::annotation_map_tile()</a></code> for finer control;
<code>zoom</code> and <code>progress</code> are used here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"predicted"</span>, map_type <span class="op">=</span> <span class="st">"cartodark"</span>, zoom <span class="op">=</span> <span class="fl">4</span>, progress <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_1b.jpg" style="width:95.0%"></p>
</div>
<div class="section level4">
<h4 id="control-track-components">Control track components<a class="anchor" aria-label="anchor" href="#control-track-components"></a>
</h4>
<p>We can add and remove certain track components by using the
<code>aes</code> argument and <code><a href="../reference/aes_lst.html">aes_lst()</a></code> function. Here, the
observed locations (orange triangles) and track lines have been turned
on and the move persistence index has been turned off.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>obs<span class="op">=</span><span class="cn">TRUE</span>, line<span class="op">=</span><span class="cn">TRUE</span>, mp<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"p"</span>, aes <span class="op">=</span> <span class="va">my.aes</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_2.jpg" style="width:95.0%"></p>
<p>Note that when turning off the move persistence index, tracks are
automatically given unique colours. This can be turned off by using
<code>by.id = FALSE</code>.</p>
<p>Additional control over mapping aesthetics can be gained by viewing
and editing the <code>my.aes$df</code> data.frame created by
<code><a href="../reference/aes_lst.html">aes_lst()</a></code>. We can subset components and assign new values
as needed, here we change the observation colour and shape from orange
triangles to firebrick diamonds. We also set <code>by.id = FALSE</code>
so all tracks are displayed in a unique colour (default is
“dodgerblue”).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.aes</span><span class="op">$</span><span class="va">df</span></span>
<span></span>
<span><span class="va">my.aes</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"firebrick"</span></span>
<span><span class="va">my.aes</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">shape</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">18</span></span>
<span></span>
<span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>    what <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>    aes <span class="op">=</span> <span class="va">my.aes</span>, </span>
<span>    by.id <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_3.jpg" style="width:95.0%"></p>
<p>Alternatively, we can colour estimated locations by their date to
better see how tracks evolve over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>    what <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>    aes <span class="op">=</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>mp<span class="op">=</span><span class="cn">FALSE</span>, conf<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>    by.date <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>    by.id<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_4.jpg" style="width:95.0%"></p>
<p>If you don’t like the default colour palettes, these can be changed
by modifying the default <code>aes</code> object. Here, the
<code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors()</a></code> function is used to specify a new colour
palette for displaying date-along-track.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>    what <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>    aes <span class="op">=</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>mp<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                  conf<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                  date_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, <span class="st">"Plasma"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    by.date <span class="op">=</span> <span class="cn">TRUE</span>, by.id<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_5.jpg" style="width:95.0%"></p>
<p>And similarly for displaying move persistence.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>    what <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>    aes <span class="op">=</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>mp_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_6.jpg" style="width:95.0%"></p>
</div>
<div class="section level4">
<h4 id="change-projection">Change projection<a class="anchor" aria-label="anchor" href="#change-projection"></a>
</h4>
<p>Often choosing an appropriate map projection can provide a more
meaningful view of the tracks, especially for animals that make very
broad-scale movements, such as the southern elephant seals displayed
here. This can be done easily by providing a valid
<code>proj4string</code> for the Coordinate Reference System. Here, we
project the tracks onto a polar stereographic grid with longitude
centered on 68<sup>o</sup> East, Iles Kerguelen.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>    what <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>    aes <span class="op">=</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>mp_pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=68 +datum=WGS84 +units=km"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/mapping/map_7.jpg" style="width:95.0%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Jonsen, W. James Grecian, Toby Patterson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
