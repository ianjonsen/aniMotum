<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview • foieGras</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview">
<meta property="og:description" content="foieGras">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foieGras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/SSM_fitting.html">SSM_fitting</a>
    </li>
    <li>
      <a href="../articles/SSM_validation.html">SSM_validation</a>
    </li>
    <li>
      <a href="../articles/Move_persistence_models.html">Move_persistence_models</a>
    </li>
    <li>
      <a href="../articles/Track_simulation.html">Track_simulation</a>
    </li>
    <li>
      <a href="../articles/Mapping.html">Mapping</a>
    </li>
    <li>
      <a href="../articles/Path_rerouting.html">Path_rerouting</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/ianjonsen/foieGras" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Overview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ianjonsen/foieGras/blob/HEAD/vignettes/Overview.Rmd" class="external-link"><code>vignettes/Overview.Rmd</code></a></small>
      <div class="hidden name"><code>Overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>This vignette is an extended set of examples to highlight <code>foieGras</code>’s functionality. Please, do NOT interpret these examples as instructions for conducting analysis of animal movement data. Numerous essential steps in a proper analysis have been left out of these vignettes. It is your job to understand your data, ensure you are asking the right questions of your data, and that the analyses you undertake appropriately reflect those questions. We can not do this for you!</p>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<p>This is an overview of how to use <code>foieGras</code> to filter animal track locations obtained via the Argos satellite system or (possibly) another tracking system. <code>foieGras</code> provides three state-space models (SSM’s), two for filtering (ie. estimating “true” locations and associated movement model parameters, while accounting for error-prone observations), and another for filtering and estimating move persistence - an index of movement behaviour:</p>
<ul>
<li>a simple <em>Random Walk</em> model, <code>rw</code>
</li>
<li>a <em>Correlated Random Walk</em> model, <code>crw</code>
</li>
<li>a <em>Move Persistence</em> model, <code>mp</code>
</li>
</ul>
<p>the models are continuous-time models, that is, they account for the time intervals between successive observations, thereby naturally accounting for the often irregularly-timed nature of animal tracking data. We won’t dwell on the details of the models here (see <a href="https://movementecologyjournal.biomedcentral.com/articles/10.1186/s40462-020-00217-7" class="external-link">Jonsen et al. 2020</a> for details on the <code>crw</code> model), except to say there may be advantages to choosing one over the other in certain circumstances. The <em>Random Walk</em> model tends not to deal well with small to moderate gaps (relative to a specified time step) in observed locations and can over-fit to particularly noisy data. The <em>Correlated Random Walk</em> model can often deal better with these small to moderate data gaps and appropriately smooth through noisy data but tends to estimate nonsensical (i.e., ‘looping’ artefacts) movement through larger data gaps, especially when animals are mostly stationary during those gaps. The <em>Move Persistence</em> model can be more robust to data gaps up to a point, and estimates time-varying move persistence <span class="math inline">\(\gamma_t\)</span> along the track, which provides an index of how an animal’s movement behaviour varies in space and time.</p>
<p>Additionally, <code>foieGras</code> provides separate models (<code>mpm</code>, <code>jmpm</code>) for estimating a move persistence <em>after</em> fitting either the <code>rw</code> or <code>crw</code> SSM (see <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecy.2566" class="external-link">Jonsen et al. 2019</a> for details). The <code>mpm</code> is fit to individual tracks, whereas the <code>jmpm</code> is fit to multiple tracks simultaneously with a variance parameter that is estimated jointly across the tracks. This latter model can often better resolve subtle changes in movement behaviour along tracks that lack much contrast in movements. Both models can be fit to time-regularized locations (discrete-time models) or to time-irregular locations (continuous-time models). See <a href="https://www.int-res.com/abstracts/meps/v565/p237-249/" class="external-link">Auger-Méthé et al. 2017</a> for an example of the latter. These models can be fit to animal tracks, regardless of the geolocation technology used.</p>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p><code>foieGras</code> expects data to be provided in one of several possible formats.</p>
<ol style="list-style-type: decimal">
<li>a <code>data.frame</code> or <code>tibble</code> that looks like this</li>
</ol>
<pre><code><span class="co">#&gt;      id                date lc      lon       lat  smaj smin eor</span>
<span class="co">#&gt; 1 54591 2012-03-05 05:09:33  1 110.5707 -66.42752  2442  416  42</span>
<span class="co">#&gt; 2 54591 2012-03-06 04:55:14  0 110.3402 -66.39579 49660  391  90</span>
<span class="co">#&gt; 3 54591 2012-03-07 04:23:10  A 110.4778 -66.45266  5032  472  93</span>
<span class="co">#&gt; 4 54591 2012-03-07 21:23:06  A 110.3749 -66.39622  4007  286 116</span>
<span class="co">#&gt; 5 54591 2012-03-09 04:27:49  B 110.4732 -66.48743 13063  956  82</span>
<span class="co">#&gt; 6 54591 2012-03-10 00:10:41  A 110.5014 -66.43516  5099  478  79</span></code></pre>
<p>where the Argos data are provided via CLS Argos’ Kalman filter model (KF) and include error ellipse information for each observed location.</p>
<ol start="2" style="list-style-type: decimal">
<li>a <code>data.frame</code> or <code>tibble</code> that looks like this</li>
</ol>
<pre><code><span class="co">#&gt;             id                date lc   lon    lat</span>
<span class="co">#&gt; 1 ct109-085-14 2015-02-03 00:11:02  B 70.45 -49.93</span>
<span class="co">#&gt; 2 ct109-085-14 2015-02-03 13:26:37  B 71.00 -50.21</span>
<span class="co">#&gt; 3 ct109-085-14 2015-02-03 21:53:15  B 71.31 -50.37</span>
<span class="co">#&gt; 4 ct109-085-14 2015-02-04 04:05:35  A 71.64 -50.43</span>
<span class="co">#&gt; 5 ct109-085-14 2015-02-04 17:12:42  B 72.04 -50.46</span>
<span class="co">#&gt; 6 ct109-085-14 2015-02-05 02:05:44  B 72.44 -50.47</span></code></pre>
<p>where the Argos data are provided via CLS Argos’ Least-Squares model (LS) and do not include error ellipse information.</p>
<ol start="3" style="list-style-type: decimal">
<li>a <code>data.frame</code> or <code>tibble</code> that includes observations with missing KF error ellipse information</li>
</ol>
<pre><code><span class="co">#&gt;      id                date lc      lon       lat  smaj smin eor</span>
<span class="co">#&gt; 1 54591 2012-03-05 05:09:33  1 110.5707 -66.42752  2442  416  42</span>
<span class="co">#&gt; 2 54591 2012-03-06 04:55:14  0 110.3402 -66.39579 49660  391  90</span>
<span class="co">#&gt; 3 54591 2012-03-07 04:23:10  A 110.4778 -66.45266    NA   NA  NA</span>
<span class="co">#&gt; 4 54591 2012-03-07 21:23:06  A 110.3749 -66.39622    NA   NA  NA</span>
<span class="co">#&gt; 5 54591 2012-03-09 04:27:49  B 110.4732 -66.48743    NA   NA  NA</span>
<span class="co">#&gt; 6 54591 2012-03-10 00:10:41  A 110.5014 -66.43516  5099  478  79</span></code></pre>
<p>in this situation, <code>foieGras</code> treats observations with missing error ellipse information as though they are LS-based observations.</p>
<ol start="4" style="list-style-type: decimal">
<li>an <code>sf-tibble</code> where observations have any of the previous 3 structures and also include <code>CRS</code> information</li>
</ol>
<pre><code><span class="co">#&gt;      id                date lc  smaj smin eor                   geometry</span>
<span class="co">#&gt; 1 54591 2012-03-05 05:09:33  1  2442  416  42 POINT (2430.943 -912.3109)</span>
<span class="co">#&gt; 2 54591 2012-03-06 04:55:14  0 49660  391  90  POINT (2437.96 -903.7763)</span>
<span class="co">#&gt; 3 54591 2012-03-07 04:23:10  A  5032  472  93 POINT (2429.753 -907.3739)</span>
<span class="co">#&gt; 4 54591 2012-03-07 21:23:06  A  4007  286 116 POINT (2437.367 -905.2335)</span>
<span class="co">#&gt; 5 54591 2012-03-09 04:27:49  B 13063  956  82 POINT (2426.138 -905.8045)</span>
<span class="co">#&gt; 6 54591 2012-03-10 00:10:41  A  5099  478  79 POINT (2431.234 -909.0692)</span></code></pre>
<ol start="5" style="list-style-type: decimal">
<li>a <code>data.frame</code>, <code>tibble</code> or <code>sf-tibble</code> where processed GLS data are provided and include longitude and latitude error SD’s (in degrees). In this case, the <code>lc</code> class is set to <code>GL</code> for all GLS locations.</li>
</ol>
<pre><code><span class="co">#&gt;      id                date lc   lon lat    lonerr    laterr</span>
<span class="co">#&gt; 1 54632 2022-05-15 16:13:09 GL 100.0 -55 0.0281554 3.9989826</span>
<span class="co">#&gt; 2 54632 2022-05-16 04:13:09 GL 100.5 -54 0.3326973 0.8766341</span>
<span class="co">#&gt; 3 54632 2022-05-16 16:13:09 GL 101.0 -53 0.3235498 0.1343692</span>
<span class="co">#&gt; 4 54632 2022-05-17 04:13:09 GL 101.5 -52 0.1152722 0.1052994</span>
<span class="co">#&gt; 5 54632 2022-05-17 16:13:09 GL 102.0 -51 0.9835511 0.2030018</span></code></pre>
<ol start="6" style="list-style-type: decimal">
<li>a <code>data.frame</code>, <code>tibble</code> or <code>sf-tibble</code> where GPS data are provided. In this case, the <code>lc</code> class is set to <code>G</code> for all GPS locations.</li>
</ol>
<pre><code><span class="co">#&gt;         id                date lc  lon   lat</span>
<span class="co">#&gt; 1 F02-B-17 2022-05-15 16:13:09  G 70.1 -49.2</span>
<span class="co">#&gt; 2 F02-B-17 2022-05-15 17:13:09  G 70.6 -48.2</span>
<span class="co">#&gt; 3 F02-B-17 2022-05-15 18:13:09  G 71.1 -47.2</span>
<span class="co">#&gt; 4 F02-B-17 2022-05-15 19:13:09  G 71.6 -46.2</span>
<span class="co">#&gt; 5 F02-B-17 2022-05-15 20:13:09  G 72.1 -45.2</span></code></pre>
<ol start="7" style="list-style-type: decimal">
<li>a <code>data.frame</code>, <code>tibble</code> or <code>sf-tibble</code> where any combination of Argos, GLS or GPS locations can be intermixed - though, most typically this would be a combination of Argos and GPS locations.</li>
</ol>
<pre><code><span class="co">#&gt;         id                date lc  lon   lat  smaj smin eor</span>
<span class="co">#&gt; 1 F02-B-17 2017-09-17 05:20:00  G 70.1 -49.2    NA   NA  NA</span>
<span class="co">#&gt; 2 F02-B-17 2017-10-04 14:35:01  2 70.2 -49.1  1890   45  77</span>
<span class="co">#&gt; 3 F02-B-17 2017-10-05 04:03:25  G 70.1 -49.3    NA   NA  NA</span>
<span class="co">#&gt; 4 F02-B-17 2017-10-05 06:28:20  A 71.1 -48.7 28532 1723 101</span>
<span class="co">#&gt; 5 F02-B-17 2017-10-05 10:21:18  B 70.8 -48.5 45546 3303  97</span></code></pre>
</div>
<div class="section level3">
<h3 id="fit-a-model">Fit a model<a class="anchor" aria-label="anchor" href="#fit-a-model"></a>
</h3>
<p>Model fitting for quality control of locations is comprised of 2 steps: a prefilter step where a number of checks are made on the input data (see <code><a href="../reference/fit_ssm.html">?foieGras::fit_ssm</a></code> for details), including applying the <code><a href="https://rdrr.io/pkg/trip/man/sda.html" class="external-link">trip::sda</a></code> filter to identify extreme outlier observations. Additionally, if the input data are not supplied as an <code>sf</code> object, the prefilter uses the World Mercator projection, EPSG 3395. The SSM is then fit to this projected version of the data. The prefilter step is fully automated and invoked via the <code>fit_ssm</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## prefilter and fit Random Walk SSM using a 24 h time step</span>
<span class="va">fit</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/fit_ssm.html">fit_ssm</a></span><span class="op">(</span>
    <span class="va">ellie</span>,
    model <span class="op">=</span> <span class="st">"rw"</span>,
    time.step <span class="op">=</span> <span class="fl">24</span>,
    control <span class="op">=</span> <span class="fu"><a href="../reference/ssm_control.html">ssm_control</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>These are the minimum arguments required: the input data, the model (<code>rw</code>, <code>crw</code>, or <code>mp</code>) and the time.step (in h) to which locations are predicted (the argument <code>control = ssm_control(verbose = 0)</code> turns off parameter optimization tracing and is included here for vignette tidiness). Additional control can be exerted over the prefiltering step, via the <code>vmax</code>, <code>ang</code>, <code>distlim</code>, <code>spdf</code> and <code>min.dt</code> arguments. see <code><a href="../reference/fit_ssm.html">?fit_ssm</a></code> for details, the defaults for these arguments are quite conservative (for non-flying species), usually leading to relative few observations being flagged to be ignored by the SSM. Additional control over the optimization can also be exerted via the <code>control = ssm_control()</code> argument, see <code><a href="../reference/ssm_control.html">?ssm_control</a></code> for details.</p>
<p><code>fit_ssm</code> can be applied to single or multiple tracks, without modification. The specified SSM is fit to each individual separately and the resulting output is a compound <code>tibble</code> with rows corresponding to each individual <code>ssm_df</code> fit object. The <code>converged</code> column indicates whether each model fit converged successfully.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## list fit outcomes for both seals</span>
<span class="va">fit</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 5</span></span>
<span class="co">#&gt;   id    ssm          converged pdHess pmodel</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54591 <span style="color: #949494;">&lt;ssm [15]&gt;</span>   TRUE      TRUE   rw</span></code></pre></div>
<p>Individual <code>id</code> is displayed in the 1st column, all fit output resides in a list (<code>ssm</code>) in the 2nd column, <code>convergence</code> status (whether the optimizer found a global minimum) of each model fit is displayed in the 3rd column, whether the Hessian matrix was positive-definite and could be solved to obtain parameter standard errors (<code>pdHess</code>) is displayed in the 4th column, and the specified process model (<code>rw</code>, <code>crw</code>, or <code>mp</code>) in the 5th column. In some cases, the optimizer will converge but the Hessian matrix is not positive-definite, which typically indicates the optimizer converged on a local minimum. In this case, some standard errors may be calculated but not all. One possible solution is to try specifying a longer <code>time.step</code> or set <code>time.step = NA</code> to turn off predictions and return only fitted values (location estimates at the pre-filtered observation times). If <code>pdHess = FALSE</code> persists then careful inspection of the supplied data is warranted to determine if suspect observations not identified by <code>prefilter</code> are present. The excellent <a href="https://CRAN.R-project.org/package=glmmTMB/vignettes/troubleshooting.html" class="external-link">glmmTMB troubleshooting vignette</a> may also provide hints at solutions. Convergence failures should be examined for potential data issues, however, in some cases changes to the optimization parameters via <code><a href="../reference/ssm_control.html">ssm_control()</a></code> (see <code><a href="../reference/fit_ssm.html">?fit_ssm</a></code> and <code><a href="../reference/ssm_control.html">?ssm_control</a></code> on usage) may overcome mild issues (see <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">?nlminb</a></code> or <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">?optim</a></code> for details on optimization control parameters).</p>
</div>
<div class="section level3">
<h3 id="access-results">Access results<a class="anchor" aria-label="anchor" href="#access-results"></a>
</h3>
<p>Summary information about the fit can be obtained via the <code>summary</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt;  Animal id Model Time n.obs n.filt n.fit n.pred n.rr converged   AICc</span>
<span class="co">#&gt;      54591    rw   24    64      6    58    113    .      TRUE 1350.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; --------------</span>
<span class="co">#&gt; 54591 </span>
<span class="co">#&gt; --------------</span>
<span class="co">#&gt;  Parameter Estimate Std.Err</span>
<span class="co">#&gt;      rho_p  -0.8593  0.0365</span>
<span class="co">#&gt;    sigma_x   4.6566  0.4494</span>
<span class="co">#&gt;    sigma_y   3.9633  0.3802</span></code></pre></div>
<p>The summary table lists information about the fit, including the number of observations in the input data (<code>n.obs</code>), the number of observation flagged to be ignored by the SSM (<code>n.filt</code>), the number of fitted location estimates (<code>n.fit</code>), the number of predicted location estimates (<code>n.pred</code>), the number of rerouted location estimates (if present, <code>n.rr</code>), model convergence status, and AICc. When fitting to multiple individuals, these statistics are repeated on separate lines for each individual. Separate tables of SSM parameter estimates and their SE’s are also printed for each individual. The parameter estimates displayed vary depending on the SSM process model selected by the user (<code>rw</code>, <code>crw</code>, or <code>mp</code>) and the automatically chosen measurement model(s). Here, <code>sigma_x</code> and <code>sigma_y</code> are the process error standard deviations in the x and y directions, <code>rho_p</code> is the correlation parameter in the covariance term. The <code>Std. Error</code> column lists the standard errors, calculated via the Delta method (see TMB documentation for details), for each estimated parameter.</p>
<p><code>fit_ssm</code> usually returns two sets of estimated locations in the model fit object: fitted values and predicted values. The fitted values occur at the times of the observations (that passed the prefilter step) to which the SSM was fit. The predicted values occur at the regular time intervals specified by the <code>time.step</code> argument. If <code>time.step = NA</code>, then no predicted values are estimated or returned in the model fit object.</p>
<p>Users can obtain the fitted or predicted locations as a data.frame by using <code><a href="../reference/grab.html">grab()</a></code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## grab fitted locations</span>
<span class="va">floc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab.html">grab</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"fitted"</span><span class="op">)</span>
<span class="va">floc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 8</span></span>
<span class="co">#&gt;   id    date                  lon   lat      x      y  x.se  y.se</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54591 2012-03-05 <span style="color: #949494;">05:09:33</span>  111. -<span style="color: #BB0000;">66.4</span> <span style="text-decoration: underline;">12</span>309. -<span style="color: #BB0000; text-decoration: underline;">9</span><span style="color: #BB0000;">956.</span>  1.18 1.30 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54591 2012-03-06 <span style="color: #949494;">04:55:14</span>  110. -<span style="color: #BB0000;">66.4</span> <span style="text-decoration: underline;">12</span>286. -<span style="color: #BB0000; text-decoration: underline;">9</span><span style="color: #BB0000;">947.</span> 28.6  0.276</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54591 2012-03-09 <span style="color: #949494;">04:27:49</span>  110. -<span style="color: #BB0000;">66.5</span> <span style="text-decoration: underline;">12</span>299. -<span style="color: #BB0000; text-decoration: underline;">9</span><span style="color: #BB0000;">972.</span>  8.88 1.41</span>

<span class="co">## grab predicted locations in projected form</span>
<span class="va">ploc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/grab.html">grab</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"predicted"</span>, as_sf <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ploc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>
<span class="co">#&gt; Simple feature collection with 3 features and 4 fields</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 12286.44 ymin: -9955.649 xmax: 12308.66 ymax: -9946.821</span>
<span class="co">#&gt; CRS:           +proj=merc +lon_0=0 +datum=WGS84 +units=km +no_defs</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span>
<span class="co">#&gt;   id    date                 x.se   y.se             geometry</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;POINT [km]&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 54591 2012-03-05 <span style="color: #949494;">05:00:00</span>  1.39  1.44  (12308.66 -9955.649)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 54591 2012-03-06 <span style="color: #949494;">05:00:00</span> 28.6   0.419 (12286.44 -9946.821)</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 54591 2012-03-07 <span style="color: #949494;">05:00:00</span> 92.9  77.4     (12290.61 -9955.4)</span></code></pre></div>
<p>Here, the fitted location data.frame includes individual id, date-time, longitude, latitude, x and y (typically from the default World Mercator projection) and their standard errors (in km). The predicted location data.frame is an <code>sf</code> object with geometry and Coordinate Reference System information. This <code>sf</code> output format is useful for custom mapping or calculating derived quantities from the estimated locations.</p>
</div>
<div class="section level3">
<h3 id="visualise-model-fit">Visualise model fit<a class="anchor" aria-label="anchor" href="#visualise-model-fit"></a>
</h3>
<p>A generic <code>plot</code> (see <code><a href="../reference/plot.ssm_df.html">?plot.ssm_df</a></code>) method allows a quick visual of the SSM fit to the data:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot time-series of the fitted values</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"fitted"</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; $`54591`</span></code></pre></div>
<p><img src="Overview_files/figure-html/fit%20plot-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># plot fitted values as a 2-d track</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"predicted"</span>, type <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">#&gt; $`54591`</span></code></pre></div>
<p><img src="Overview_files/figure-html/fit%20plot-2.png" width="672"></p>
<p>The predicted values (red points) are the state estimates predicted at regular time intervals, specified by <code>time.step</code> (here a 24 h interval). These estimates are plotted on top of 2 x SE intervals (red-filled ribbon), and the observations that passed the <code>prefilter</code> stage (blue points and blue rug at bottom). Fitted values are the state estimates corresponding to the time of each observation; their time series are plotted by default - <code>plot(fit)</code>. A 2-D time series plot of the track is invoked by the argument <code>type = 2</code>, and includes the 95 % confidence ellipses (red-filled ellipses) around the predicted locations.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Jonsen, W. James Grecian, Toby Patterson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
