<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Path_rerouting • foieGras</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Path_rerouting">
<meta property="og:description" content="foieGras">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">foieGras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/SSM_fitting.html">SSM_fitting</a>
    </li>
    <li>
      <a href="../articles/SSM_validation.html">SSM_validation</a>
    </li>
    <li>
      <a href="../articles/Move_persistence_models.html">Move_persistence_models</a>
    </li>
    <li>
      <a href="../articles/Track_simulation.html">Track_simulation</a>
    </li>
    <li>
      <a href="../articles/Mapping.html">Mapping</a>
    </li>
    <li>
      <a href="../articles/Path_rerouting.html">Path_rerouting</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/ianjonsen/foieGras" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Path_rerouting_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Path_rerouting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ianjonsen/foieGras/blob/HEAD/vignettes/Path_rerouting.Rmd" class="external-link"><code>vignettes/Path_rerouting.Rmd</code></a></small>
      <div class="hidden name"><code>Path_rerouting.Rmd</code></div>

    </div>

    
    
<p>When fitting SSM’s to error-prone tracking data, estimated locations can occur in places where animals are known to not travel. Marine animal tracks traversing land masses, while not impossible for animals that haulout periodically or depart from and return to a breeding colony, are an obvious issue that is computationally difficult to address within the SSM optimization. In this case, a pragmatic solution would apply a post-hoc adjustment of locations occurring on land.</p>
<div class="section level3">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h3>
<p>Here’s an example using a Weddell seal track from Scott Base, Antarctica. Note the numerous Argos locations (red) and SSM_predicted locations (blue) on land/fast-ice.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit SSM to Weddell seal Argos data</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_ssm.html">fit_ssm</a></span><span class="op">(</span><span class="va">wese_sb</span>, 
               vmax <span class="op">=</span> <span class="fl">3</span>,
               model <span class="op">=</span> <span class="st">"mp"</span>,
               time.step <span class="op">=</span> <span class="fl">2</span>,
               control <span class="op">=</span> <span class="fu"><a href="../reference/ssm_control.html">ssm_control</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co"># map the Argos locations</span>
<span class="va">aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>est<span class="op">=</span><span class="cn">FALSE</span>, obs<span class="op">=</span><span class="cn">TRUE</span>, conf<span class="op">=</span><span class="cn">FALSE</span>, mp<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">aes</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">col</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"firebrick"</span>
<span class="va">aes</span><span class="op">$</span><span class="va">df</span><span class="op">$</span><span class="va">size</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.25</span>

<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, 
    what <span class="op">=</span> <span class="st">"p"</span>, 
    aes <span class="op">=</span> <span class="va">aes</span>, 
    silent<span class="op">=</span><span class="cn">TRUE</span>, 
    crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=166 +datum=WGS84 +units=km"</span>, 
    ext.rng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>

<span class="co"># map the SSM-predicted locations</span>
<span class="va">aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>obs<span class="op">=</span><span class="cn">FALSE</span>, conf<span class="op">=</span><span class="cn">FALSE</span>, mp<span class="op">=</span><span class="cn">FALSE</span>, line<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, 
    what <span class="op">=</span> <span class="st">"p"</span>, 
    aes <span class="op">=</span> <span class="va">aes</span>, 
    silent<span class="op">=</span><span class="cn">TRUE</span>, 
    crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=166 +datum=WGS84 +units=km"</span>, 
    ext.rng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">m1</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Argos locations"</span><span class="op">)</span> <span class="op">|</span> <span class="va">m2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SSM-predicted locations"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span>
    <span class="fu">theme</span><span class="op">(</span>panel.grid<span class="op">=</span> <span class="fu">element_line</span> <span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="images/path_rerouting/map_1ab.jpg" style="width:95.0%"></p>
</div>
<div class="section level3">
<h3 id="route_path">
<code>route_path()</code><a class="anchor" aria-label="anchor" href="#route_path"></a>
</h3>
<p>Thanks to the <code>pathroutr</code> R package (<a href="https://jmlondon.github.io/pathroutr/" class="external-link uri">https://jmlondon.github.io/pathroutr/</a>), we can quickly and objectively re-route estimated tracks off of land. <code><a href="../reference/route_path.html">route_path()</a></code> is a wrapper function for the <code>pathroutr</code> package, which must be installed separately (via <code>install.packages("pathroutr", repos = "https://jmlondon.r-universe.dev")</code>). Our implementation is intended to be easy to use and integrate into a <code>foieGras</code> workflow, but for complicated re-routing problems we recommend using the <code>pathroutr</code> functions directly.</p>
<div class="section level4">
<h4 id="re-route-weddell-seal-ssm-predicted-locations">re-route Weddell seal SSM-predicted locations<a class="anchor" aria-label="anchor" href="#re-route-weddell-seal-ssm-predicted-locations"></a>
</h4>
<p>Here we take the SSM fit object and pass the re-routed locations back to it.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/route_path.html">route_path</a></span><span class="op">(</span><span class="va">fit</span>,
                    what <span class="op">=</span> <span class="st">"predicted"</span>,
                    map_scale <span class="op">=</span> <span class="fl">10</span>,
                    buffer <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></code></pre></div>
<p>We can then map these locations to see the improvement.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my.aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/aes_lst.html">aes_lst</a></span><span class="op">(</span>line <span class="op">=</span> <span class="cn">TRUE</span>,
               conf <span class="op">=</span> <span class="cn">FALSE</span>,
               mp <span class="op">=</span> <span class="cn">FALSE</span>,
               obs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, 
          what <span class="op">=</span> <span class="st">"predicted"</span>, 
          aes <span class="op">=</span> <span class="va">my.aes</span>, 
          crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=166 +datum=WGS84 +units=km"</span>,
          ext.rng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span>,
          silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/map.html">map</a></span><span class="op">(</span><span class="va">fit</span>, 
          what <span class="op">=</span> <span class="st">"rerouted"</span>, 
          aes <span class="op">=</span> <span class="va">my.aes</span>, 
          crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=166 +datum=WGS84 +units=km"</span>,
          ext.rng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span>,
          silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="op">(</span><span class="va">m1</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"SSM-predicted locations"</span><span class="op">)</span> <span class="op">|</span> <span class="va">m2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Re-routed locations"</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span>
  <span class="fu">theme</span><span class="op">(</span>panel.grid<span class="op">=</span> <span class="fu">element_line</span> <span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="images/path_rerouting/map_2ab.jpg" style="width:95.0%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Jonsen, W. James Grecian, Toby Patterson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
