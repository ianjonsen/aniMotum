<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit Continuous-Time State-Space and Latent Variable Models for Quality Control of Argos Satellite (and Other) Telemetry Data and for Estimating Movement Behaviour • foieGras</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Fit Continuous-Time State-Space and Latent Variable Models for Quality Control of Argos Satellite (and Other) Telemetry Data and for Estimating Movement Behaviour">
<meta property="og:description" content="Fits continuous-time random walk and correlated random walk state-space models for quality control animal tracking data (Argos, processed light-level geolocation, GPS). Template Model Builder (TMB) is used for fast estimation. The Argos data can be: (older) least squares-based locations; (newer) Kalman filter-based locations with error ellipse information; or a mixture of both. The models estimate two sets of location states corresponding to: 1) each observation, which are (usually) irregularly timed; and 2) user-specified time intervals (regular or irregular). Latent variable models are provided to estimate move persistence along tracks as an index of behaviour. Track simulation functions are provided. Jonsen I, McMahon CR, Patterson TA, Auger-Méthé M, Harcourt R, Hindell MA, Bestley S (2019) Movement responses to environment: fast inference of variation among southern elephant seals with a mixed effects model. Ecology 100:e02566 &lt;doi:10.1002/ecy.2566&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">foieGras</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ianjonsen/foieGras/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><strong>foieGras</strong> - fit latent variable movement models to animal tracking data for location quality control and behavioural inference</p>
<!-- badges: start -->

<p><img src="reference/figures/README-logo-1.png" style="display: block; margin: auto;"></p>
<p><code>foieGras</code> is an R package that fits a continuous-time model (RW or CRW) in state-space form to filter Argos (or GLS) satellite location data. Template Model Builder (<code>TMB</code>) is used for fast estimation. Argos data can be either (older) Least Squares-based locations, (newer) Kalman Filter-based locations with error ellipse information, or a mixture of the two. The state-space model estimates two sets of location states: 1) corresponding to each observation, which are usually irregularly timed (fitted states); and 2) corresponding to (usually) regular time intervals specified by the user (predicted states). Locations are returned as both LongLat and on the Mercator projection (units=km). Additional models are provided to infer movement behaviour along the SSM-estimated most-probable track.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>First, ensure you have R version &gt;= 3.6.0 installed (preferably R 4.0.0 or higher):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Version.html" class="external-link">R.Version</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="from-cran">From CRAN<a class="anchor" aria-label="anchor" href="#from-cran"></a>
</h3>
<p><code>foieGras</code> is on <a href="https://cran.r-project.org/package=foieGras/" class="external-link">CRAN</a> and can be downloaded within <code>R</code>, in the usual way <code>install.packages("foieGras")</code> or, more completely: <code>install.packages("foieGras", depedencies = c("Imports","LinkingTo","Suggests"))</code></p>
</div>
<div class="section level3">
<h3 id="from-github-source">From GitHub (source)<a class="anchor" aria-label="anchor" href="#from-github-source"></a>
</h3>
<p>On PC’s running Windows, ensure you have installed <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a></p>
<p>On Mac’s, ensure you have installed the <a href="https://developer.apple.com/download/more/" class="external-link">Command Line Tools for Xcode</a> by executing <code>xcode-select --install</code> in the terminal; or you can download the latest version from the URL (free developer registration may be required). A full Xcode install uses up a lot of disk space and is not required. Also, ensure you have a suitable Gnu Fortran compiler installed (e.g., <a href="https://github.com/fxcoudert/gfortran-for-macOS/releases" class="external-link uri">https://github.com/fxcoudert/gfortran-for-macOS/releases</a>).</p>
<p>To get the very latest <code>foieGras</code> stable version, you can install from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ianjonsen/foieGras@staging"</span><span class="op">)</span></code></pre></div>
<p>Or, for a more thoroughly tested earlier version:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ianjonsen/foieGras"</span><span class="op">)</span></code></pre></div>
<p>Note: there can be issues getting compilers to work properly, especially on a Mac with OS X 10.13.x or higher. If you encounter install and compile issues, I recommend you consult the excellent information on the <a href="https://github.com/glmmTMB/glmmTMB" class="external-link">glmmTMB</a> GitHub.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-example">Basic example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h2>
<p><code>foieGras</code> is intended to be as easy to use as possible. Here’s an example showing how to quality-control Argos tracking data, and infer a behavioural index along the estimated animal tracks:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ianjonsen/foieGras/" class="external-link">foieGras</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>

<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_ssm.html">fit_ssm</a></span><span class="op">(</span><span class="va">sese</span>, vmax<span class="op">=</span> <span class="fl">4</span>, model <span class="op">=</span> <span class="st">"crw"</span>, time.step <span class="op">=</span> <span class="fl">24</span>, control <span class="op">=</span> <span class="fu"><a href="reference/ssm_control.html">ssm_control</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="va">fmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_mpm.html">fit_mpm</a></span><span class="op">(</span><span class="va">fit</span>, what <span class="op">=</span> <span class="st">"predicted"</span>, model <span class="op">=</span> <span class="st">"jmpm"</span>, control <span class="op">=</span> <span class="fu"><a href="reference/mpm_control.html">mpm_control</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fmp</span>, pages <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span>, pal <span class="op">=</span> <span class="st">"Cividis"</span>, rev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-explots1-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fmap.html">fmap</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fmp</span>, what <span class="op">=</span> <span class="st">"predicted"</span>, pal <span class="op">=</span> <span class="st">"Cividis"</span>, crs <span class="op">=</span> <span class="st">"+proj=stere +lon_0=69 +units=km +datum=WGS84"</span><span class="op">)</span>

<span class="co">## using cowplot to add southern elephant seal silhouettes to map</span>
<span class="fu">ggdraw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_plot</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_image</span><span class="op">(</span><span class="st">"inst/logo/img/sese_female_orig.png"</span>,  x<span class="op">=</span><span class="fl">0.175</span>, y<span class="op">=</span><span class="fl">0.85</span>, scale<span class="op">=</span><span class="fl">0.175</span>, hjust<span class="op">=</span><span class="fl">0.5</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">draw_image</span><span class="op">(</span><span class="st">"inst/logo/img/sese_male_orig.png"</span>,  x<span class="op">=</span><span class="fl">0.85</span>, y<span class="op">=</span><span class="fl">0.45</span>, scale<span class="op">=</span><span class="fl">0.25</span>, hjust<span class="op">=</span><span class="fl">0.5</span>, vjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-explots2-1.png" width="100%"> foo Southern elephant seal silhouettes kindly provided by:<br>
- female southern elephant seal, Sophia Volzke ([@SophiaVolzke](<a href="https://twitter.com/SophiaVolzke" class="external-link uri">https://twitter.com/SophiaVolzke</a>), University of Tasmania)<br>
- male southern elephant seal, Anton Van de Putte ([@AntonArctica](<a href="https://twitter.com/Antonarctica" class="external-link uri">https://twitter.com/Antonarctica</a>), Université Libre de Bruxelles)</p>
</div>
<div class="section level2">
<h2 id="what-to-do-if-you-encounter-a-problem">What to do if you encounter a problem<a class="anchor" aria-label="anchor" href="#what-to-do-if-you-encounter-a-problem"></a>
</h2>
<p>If you are convinced you have encountered a bug or unexpected/inconsistent behaviour when using foieGras, you can post an issue <a href="https://github.com/ianjonsen/foieGras/issues" class="external-link">here</a>. First, have a read through the posted issues to see if others have encountered the same problem and whether a solution has been offered. You can reply to an existing issue if you have the same problem and have more details to share or you can submit a new issue. To submit an issue, you will need to <em>clearly</em> describe the unexpected behaviour, include a reproducible example with a small dataset, clearly describe what you expected to happen (but didn’t), and (ideally) post a few screenshots/images that nicely illustrate the problem.</p>
</div>
<div class="section level2">
<h2 id="how-to-contribute">How to Contribute<a class="anchor" aria-label="anchor" href="#how-to-contribute"></a>
</h2>
<p>Contributions from anyone in the Movement Ecology/Bio-Logging communities are welcome. Consider submitting a feature request <a href="https://github.com/ianjonsen/foieGras/issues/new/choose" class="external-link">here</a> to start a discussion. Alternatively, if your idea is well-developed then you can submit a pull request for evaluation <a href="https://github.com/ianjonsen/foieGras/pulls" class="external-link">here</a>. Unsure about what all this means but still want to discuss your idea? then have a look through the GitHub pages of community-built R packages like <a href="https://github.com/tidyverse/dplyr" class="external-link">tidyverse/dplyr</a> for examples.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the foieGras project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>Development of this R package was funded by a consortium of partners including: Macquarie University; the US Office of Naval Research (ONR Marine Mammal Biology; grant N00014-18-1-2405); Australia’s Integrated Marine Observing System (IMOS); Canada’s Ocean Tracking Network (OTN); Taronga Conservation Society; Birds Canada; and Innovasea/Vemco. Additional support was provided by France’s Centre de Synthèse et d’Analyse sur la Biodiversite, part of the Fondation pour la Recherche sur la Biodiversité.</p>
<p>Example southern elephant seal data included in the package were sourced from the IMOS Animal Tracking Facility. IMOS is a national collaborative research infrastructure, supported by the Australian Government and operated by a consortium of institutions as an unincorporated joint venture, with the University of Tasmania as Lead Agent. IMOS supported elephant seal fieldwork on Iles Kerguelen conducted as part of the IPEV program No 109 (PI H. Weimerskirch) and the SNO-MEMO program (PI C. Guinet). SMRU SRDL-CTD tags were partly funded by CNES-TOSCA and IMOS. All tagging procedures were approved and executed under University of Tasmania Animal Ethics Committee guidelines.</p>
<p>Animal silhouettes used in the <code>foieGras</code> logo were obtained and modified from sources:<br>
- southern elephant seal, Anton Van de Putte ([@AntonArctica](<a href="https://twitter.com/Antonarctica" class="external-link uri">https://twitter.com/Antonarctica</a>), Université Libre de Bruxelles)<br>
- humpback whale, Chris Huh via <a href="http://phylopic.org" class="external-link">Phylopic.org</a> Creative Commons Attribution-ShareAlike 3.0 Unported<br>
- mallard duck, Maija Karala via <a href="http://phylopic.org" class="external-link">Phylopic.org</a> Creative Commons Attribution-ShareAlike 3.0 Unported<br>
- leatherback turtle, James R. Spotila &amp; Ray Chatterji via <a href="http://phylopic.org" class="external-link">Phylopic.org</a> Public Domain Dedication 1.0<br>
- white shark, Margo Michaud via <a href="http://phylopic.org" class="external-link">Phylopic.org</a> Public Domain Dedication 1.0<br>
- king penguin, Steven Traver via <a href="http://phylopic.org" class="external-link">Phylopic.org</a> Public Domain Dedication 1.0</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=foieGras" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ianjonsen/foieGras/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ianjonsen/foieGras/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing foieGras</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ian Jonsen <br><small class="roles"> Author, maintainer, copyright holder </small>  </li>
<li>James Grecian <br><small class="roles"> Author, contributor </small>  </li>
<li>Toby Patterson <br><small class="roles"> Author, contributor </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-green.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://codecov.io/github/ianjonsen/foieGras?branch=master" class="external-link"><img src="https://codecov.io/gh/ianjonsen/foieGras/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://cran.r-project.org/package=foieGras/" class="external-link"><img src="https://www.r-pkg.org/badges/version/foieGras" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://www.r-pkg.org/pkg/foieGras" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/foieGras?color=brightgreen" alt="CRAN_Downloads"></a></li>
<li><a href="https://cran.r-project.org/package=foieGras/" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/foieGras?color=brightgreen" alt="CRAN_Downloads"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.2628481" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.2628481.svg" alt="DOI"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Ian Jonsen, James Grecian, Toby Patterson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
